{"version":3,"file":"index.js","mappings":"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","sources":["webpack://single-post-query-loop-selector/./src/single-post-picker/SinglePostPicker.tsx","webpack://single-post-query-loop-selector/external window \"React\"","webpack://single-post-query-loop-selector/external window [\"wp\",\"blockEditor\"]","webpack://single-post-query-loop-selector/external window [\"wp\",\"blocks\"]","webpack://single-post-query-loop-selector/external window [\"wp\",\"components\"]","webpack://single-post-query-loop-selector/external window [\"wp\",\"compose\"]","webpack://single-post-query-loop-selector/external window [\"wp\",\"coreData\"]","webpack://single-post-query-loop-selector/external window [\"wp\",\"element\"]","webpack://single-post-query-loop-selector/external window [\"wp\",\"hooks\"]","webpack://single-post-query-loop-selector/external window [\"wp\",\"i18n\"]","webpack://single-post-query-loop-selector/webpack/bootstrap","webpack://single-post-query-loop-selector/webpack/runtime/compat get default export","webpack://single-post-query-loop-selector/webpack/runtime/define property getters","webpack://single-post-query-loop-selector/webpack/runtime/hasOwnProperty shorthand","webpack://single-post-query-loop-selector/webpack/runtime/make namespace object","webpack://single-post-query-loop-selector/./src/index.tsx"],"sourcesContent":["import { InspectorControls } from '@wordpress/block-editor';\nimport { ComboboxControl, PanelBody } from '@wordpress/components';\nimport { useEntityRecords } from '@wordpress/core-data';\nimport { useState } from '@wordpress/element';\nimport type { WP_REST_API_Post as WPRestAPIPost } from 'wp-types';\nimport { useDebounce } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\ntype SinglePostPickerProps = {\n\tattributes: {\n\t\t[ key: string ]: unknown;\n\t\tquery: {\n\t\t\t[ key: string ]: unknown;\n\t\t\tselectedPostId: string;\n\t\t};\n\t};\n\tsetAttributes: ( attributes: { [ key: string ]: unknown } ) => void;\n};\n\nconst SinglePostPicker: React.FC< SinglePostPickerProps > = ( {\n\tsetAttributes,\n\tattributes,\n} ) => {\n\tconst [ search, setSearch ] = useState( '' );\n\tconst { isResolving, records: posts } = useEntityRecords< WPRestAPIPost >(\n\t\t'postType',\n\t\tattributes?.query?.postType || 'post',\n\t\t{\n\t\t\tper_page: 10,\n\t\t\tsearch,\n\t\t}\n\t);\n\n\tconst setSearchDebounced = useDebounce( ( value ) => {\n\t\tsetSearch( value );\n\t}, 300 );\n\n\treturn (\n\t\t<>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody>\n\t\t\t\t\t<ComboboxControl\n\t\t\t\t\t\tlabel={ __(\n\t\t\t\t\t\t\t'Search for a post',\n\t\t\t\t\t\t\t'single-post-query-loop-selector'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\t\tconst newAttributes = {\n\t\t\t\t\t\t\t\tattributes,\n\t\t\t\t\t\t\t\tquery: {\n\t\t\t\t\t\t\t\t\t...attributes.query,\n\t\t\t\t\t\t\t\t\tinclude: [ value ],\n\t\t\t\t\t\t\t\t\tselectedPostId: value,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tsetAttributes( newAttributes );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonFilterValueChange={ ( value ) => {\n\t\t\t\t\t\t\tsetSearchDebounced( value );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\toptions={\n\t\t\t\t\t\t\tisResolving\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tlabel: __(\n\t\t\t\t\t\t\t\t\t\t\t\t'Loadingâ€¦',\n\t\t\t\t\t\t\t\t\t\t\t\t'single-post-query-loop-selector'\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\tvalue: 'loading',\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: posts?.map( ( post ) => ( {\n\t\t\t\t\t\t\t\t\t\tlabel: post?.title?.rendered,\n\t\t\t\t\t\t\t\t\t\tvalue: String( post?.id ),\n\t\t\t\t\t\t\t\t  } ) ) || []\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue={ attributes?.query?.selectedPostId || 'loading' }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t</>\n\t);\n};\n\nexport { SinglePostPicker };\n","module.exports = window[\"React\"];","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"blocks\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"compose\"];","module.exports = window[\"wp\"][\"coreData\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"hooks\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { registerBlockVariation } from '@wordpress/blocks';\nimport type { BlockVariation } from '@wordpress/blocks';\nimport { __ } from '@wordpress/i18n';\nimport { addFilter } from '@wordpress/hooks';\n\nimport { SinglePostPicker } from './single-post-picker';\nconst VARIATION_NAME = 'creativeandrew/single-post-query-loop-selector';\n\ninterface BlockCoreQueryAttributes extends BlockVariation {\n\tallowedControls: [ 'postType' ],\n}\n\nregisterBlockVariation( 'core/query', {\n\tname: VARIATION_NAME,\n\ttitle: __( 'Single Post Query Loop', 'single-post-query-loop-selector' ),\n\tdescription: __(\n\t\t'Allow you to search and select a single post.',\n\t\t'single-post-query-loop-selector'\n\t),\n\tcategory: 'theme',\n\tisActive: [ 'namespace' ],\n\tattributes: {\n\t\tnamespace: VARIATION_NAME,\n\t\tquery: {\n\t\t\tperPage: 1,\n\t\t\tpostType: 'post',\n\t\t\tsticky: 'exclude',\n\t\t},\n\t\tclassName: 'is-style-single-post-query-loop-selector',\n\t},\n\tallowedControls: [ 'postType' ],\n\tinnerBlocks: [\n\t\t[\n\t\t\t'core/post-template',\n\t\t\t{},\n\t\t\t[ [ 'core/post-title' ], [ 'core/post-excerpt' ] ],\n\t\t],\n\t],\n\tscope: [ 'inserter' ],\n} as BlockCoreQueryAttributes );\n\nconst isSingePostPicker = ( props: { attributes: { namespace: string } } ) => {\n\tconst {\n\t\tattributes: { namespace },\n\t} = props;\n\treturn namespace && namespace === VARIATION_NAME;\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst withAdvancedQueryControls = ( BlockEdit: React.FC ) => ( props: any ) => {\n\tif ( isSingePostPicker( props ) ) {\n\t\tconst { setAttributes, attributes } = props;\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<SinglePostPicker\n\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t/>\n\t\t\t\t<BlockEdit { ...props } />\n\t\t\t</>\n\t\t);\n\t}\n\treturn <BlockEdit { ...props } />;\n};\n\naddFilter( 'editor.BlockEdit', 'core/query', withAdvancedQueryControls );\n"],"names":["InspectorControls","ComboboxControl","PanelBody","useEntityRecords","useState","useDebounce","__","SinglePostPicker","setAttributes","attributes","search","setSearch","isResolving","records","posts","query","postType","per_page","setSearchDebounced","value","createElement","Fragment","label","onChange","newAttributes","include","selectedPostId","onFilterValueChange","options","map","post","title","rendered","String","id","registerBlockVariation","addFilter","VARIATION_NAME","name","description","category","isActive","namespace","perPage","sticky","className","allowedControls","innerBlocks","scope","isSingePostPicker","props","withAdvancedQueryControls","BlockEdit"],"sourceRoot":""}